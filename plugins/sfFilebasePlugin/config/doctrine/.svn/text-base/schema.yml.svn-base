#/**
# * This file is part of the sfFilebasePlugin package.
# *
# * For the full copyright and license information, please view the LICENSE
# * file that was distributed with this source code.
# *
# * @package   de.optimusprime.sfFilebasePlugin
# * @author    Johannes Heinen <johannes.heinen@gmail.com>
# * @license   MIT license
# * @copyright 2007-2009 Johannes Heinen <johannes.heinen@gmail.com>
# */
detect_relations: true

sfFilebaseFile:
  tableName: sf_filebase_files
  columns:
    pathname:                 { type: string(255), notnull: true }
    hash:                     { type: string(255), notnull: true }
    comment:                  { type: string, notnull: false }
    sf_filebase_directory_id: { type: integer }

  relations:
    sfFilebaseDirectory:
      local:        sf_filebase_directory_id
      foreign:      id
      onDelete: cascade
      onUpdate: cascade

  indexes:
    u1: { type: unique, fields: [pathname] }
    u2: { type: unique, fields: [hash] }

sfFilebaseDirectory:
  tableName: sf_filebase_directories
  inheritance:
    extends:  sfFilebaseFile
    type:     column_aggregation
    keyField: type
    keyValue: 1

sfFilebaseTag:
  tableName: sf_filebase_tags
  columns:
    sf_filebase_files_id: { type: integer, notnull: true }
    tag:                  { type: string(255), notnull: true }

  relations:
    sfFilebaseFile:
      local: sf_filebase_files_id
      foreign: id
      onDelete: cascade
      onUpdate: cascade

  indexes:
    i1: { fields: [tag] }