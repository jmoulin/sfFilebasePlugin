#/**
# * This file is part of the sfFilebasePlugin package.
# *
# * For the full copyright and license information, please view the LICENSE
# * file that was distributed with this source code.
# *
# * @package   de.optimusprime.sfFilebasePlugin.adminArea
# * @author    Johannes Heinen <johannes.heinen@gmail.com>
# * @license   MIT license
# * @copyright 2007-2009 Johannes Heinen <johannes.heinen@gmail.com>
# */
sfAbstractFile:
  tableName: sf_abstract_files
  abstract: true
  columns:
    filename:                   { type: string(255), notnull: true }
    hash:                       { type: string(255), notnull: true }
    comment:                    { type: string, notnull: false }
  
  actAs:
    NestedSet:
      hasManyRoots: false

sfFilebaseFile:
  tableName: sf_filebase_files
  inheritance:
    extends:  sfAbstractFile
    type:     column_aggregation
    keyField: type
    keyValue: 1

sfFilebaseDirectory:
  tableName: sf_filebase_directories
  inheritance:
    extends:  sfAbstractFile
    type:     column_aggregation
    keyField: type
    keyValue: 2
    
sfFilebaseTag:
  tableName: sf_filebase_tags
  columns:
    sf_abstract_files_id: integer
    tag:
      type: string(255)
      notnull: true

  relations:
    File:
      class:        sfAbstractFile
      local:        sf_abstract_files_id
      foreign:      id
      onDelete:     cascade
      onUpdate:     cascade
      foreignAlias: tags

  indexes:
    i1: { fields: [tag] }